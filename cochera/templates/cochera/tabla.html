{% extends "cochera/base.html" %}

{% block content %}

<form class="form-horizontal" name="grilla" method="GET" action="/tabla">
	<table class="table table-bordered">
		<tbody>
			<tr class="vertical-center">
				<th><strong>A&ntilde;o</strong></th>
				<td>
					<div class="form-group-sm">
					<select name="anio" id="anio" class="form-control">
						{% for anio_opcion in rango_anios %}
						<option {% if anio_opcion == anio %} selected="true"{% endif %}>{{ anio_opcion }}</option>
						{% endfor %}
					</select>
					</div>
				</td>
				<th><strong>Ingresos:</strong></th>
				<td>{{ total_pagos }}</td>
				<th><strong>Gastos:</strong> </th>
				<td>{{ total_gastos }}</td>
				<th><strong>Retiros:</strong> </th>
				<td>{{ total_retiros }}</td>
				<th><strong>Saldo:</strong> </th>
				<td><strong>{{ total }}</strong></td>
			</tr>
		</tbody>
	</table>
</form>

<table class="table table-striped table-condensed">
	<tr>
		<th class="text-center">Lugar</th>

		{% with pagos|first as encabezado %}
		{% for periodo in encabezado.periodos.keys %}
		<th class="text-center">{{ periodo }}/{{ anio }}</th>
		{% endfor %}
		{% endwith %}
	</tr>

	{% for clave, detalle in pagos.items %}
	<tr>
		<th class="text-center"><a href="{{ base_url }}/lugar/{{ detalle.datos.lugar_id }}" title="{{ detalle.datos.titular }}" class="bs-tooltip">{{ clave }}</a></th>

		{% for periodo, pago in detalle.periodos.items %}
		<td class="text-center">
			{% if pago.importe > 0 %}
			<a href="{{ base_url }}/pago/{{ pago.id }}"><img src="{{ base_url }}/static/admin/img/icon-yes.gif" alt="si" title="Importe: ${{ pago.importe }}<br>Fecha: {{ pago.fecha_pago|date:"d/m/Y" }}" class="bs-tooltip"></a>
			{% else %}
			<img src="{{ base_url }}/static/admin/img/icon-no.gif" alt="no">
			{% endif %}
		</td>
		{% endfor %}
	</tr>
	{% endfor %}
</table>
{% endblock %}